def calculate_checksum(panelId, text):
    etx = "0x03"
    formatted_text = r'' + text
    formatted_text = f"{panelId}{formatted_text}" + chr(int(etx, 16))
    hex_value =  formatted_text.encode().hex()
    sum_value = 0
    for i in range(0, len(hex_value), 2):
        hex_pair = hex_value[i:i+2]
        hex_number = int(hex_pair, 16)  # Rename the variable to avoid confusion
        sum_value += hex_number
    modulus_value = 0 - (sum_value % 256)
    if modulus_value < 0:
        binary_value = format(modulus_value & 0xFFFF, '016b')
    else:
        binary_value = format(modulus_value, '016b')
    last_8_bits = binary_value[-8:]
    checksum = format(int(last_8_bits, 2), '02X')
    return checksum

content = r'{\mode1\afs0\hs1\mss1{MJ001}\fs\fit2{{\isp0\pic\picw216\pich16 FE0FFE0F660C660C660C660C660CFE0FDC07000000002006300FB00DB00CF007E00F00080000F00FF00F6000300030000000F60FF60F00000000F07FF07F6006300C700EE007C003000000002006300FB00DB00CF007E00F00080000C003E007700E300C6006FE0FFE0F000000002006300FB00DB00CF007E00F0008000080018001800180010000FE0FFE0FC00060007000F8018C07060E020C00000000FE0FFE0F600030003000F00FE00F000000002006300FB00DB00CF007E00F00080000C003E007700E300C6006FE0FFE0F00000000F60FF60F00000000E004F00DB00DB00DB00F200700000000C003E007700E300C700EE007C00300000000FE0FFE0F00000000C003E007B00DB00DB00DE00DC00500000000000000000000F00098038802880288021807700000000000F8070000F00094038A048A048A040A031402E0070000700098038804080408041802F8070000000070009803880288071800700000000000F80700008000800080000000F00098038804B80420033000F807000070009C03CA040A158A059A03740000007002980388058804881C180CF81F0000F010980788008807880090077000}}}'
content = r'{\mode0\fit2{ MASSTRANS}}'
checksum_value = calculate_checksum("02", content)
print(checksum_value)   
